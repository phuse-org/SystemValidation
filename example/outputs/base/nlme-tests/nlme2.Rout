
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(nlme)
> is64bit <- .Machine$sizeof.pointer == 8
> 
> options(digits = 10)# <- see more, as we have *no* *.Rout.save file here
> ## https://stat.ethz.ch/pipermail/r-help/2014-September/422123.html
> nfm <- nlme(circumference ~ SSlogis(age, Asym, xmid, scal),
+             data = Orange,
+             fixed = Asym + xmid + scal ~ 1)
Warning message:
In (function (model, data = sys.frame(sys.parent()), fixed, random,  :
  Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase 'msMaxIter'!
> (sO <- summary(nfm))
Nonlinear mixed-effects model fit by maximum likelihood
  Model: circumference ~ SSlogis(age, Asym, xmid, scal) 
 Data: Orange 
          AIC         BIC       logLik
  279.9814148 295.5348954 -129.9907074

Random effects:
 Formula: list(Asym ~ 1, xmid ~ 1, scal ~ 1)
 Level: Tree
 Structure: General positive-definite, Log-Cholesky parametrization
         StdDev       Corr         
Asym     27.052829156 Asym   xmid  
xmid     24.269651424 -0.327       
scal     36.591343371 -0.992  0.443
Residual  7.321444055              

Fixed effects: list(Asym ~ 1, xmid ~ 1, scal ~ 1) 
           Value   Std.Error DF     t-value p-value
Asym 192.0954675 14.05323833 28 13.66912472       0
xmid 727.5864593 34.58932038 28 21.03500304       0
scal 356.5991179 30.49565923 28 11.69343857       0
 Correlation: 
     Asym   xmid  
xmid  0.277       
scal -0.193  0.665

Standardized Within-Group Residuals:
          Min            Q1           Med            Q3           Max 
-1.8185715217 -0.5213284616  0.1743432506  0.5174950964  1.6452210007 

Number of Observations: 35
Number of Groups: 5 
> vc <- VarCorr(nfm, rdig = 5)# def. 3
> storage.mode(vc) <- "double" # -> (correct) NA warning
Warning message:
In storage.mode(vc) <- "double" : NAs introduced by coercion
> cfO <- sO$tTable
> if(FALSE)
+     dput(signif(cfO[,c("Std.Error", "t-value")], 8))
> if(FALSE)
+     dput(signif(as.numeric(vc[,"StdDev"]), 8))
> 
> cfO.Ts <- list(
+     stdE.T = cbind(
+         b64nx = ## R-devel 2016-01-11, 2017-09-18; [lynne]:
+             c(14.052671, 34.587947, 30.497593,  13.669776, 21.036087, 11.692943)
+       , b32nx = ## R-devel 2016-01-11, 2017-09-18 [florence, Fedora 24 Linux]:
+             c(14.053663, 34.589821, 30.49412,   13.668653, 21.034544, 11.693889)
+       , b32Win1 = ## R-devel 2017-09-17, i386-w64-mingw32/i386,
+             ## Windows Server 2008 R2 x64 (build 7601) Service Pack 1
+             c(14.053047, 34.588589, 30.4963,    13.669349, 21.035542, 11.693282)
+       , b32Win = ## R-devel 2017-09-18, Tomas K (Win.10)
+             c(14.051902, 34.579819, 30.499807,  13.670797, 21.041722, 11.692694)
+     ),
+     stdDev = cbind(
+         b64nx = ## R-devel 2016-01-11; [lynne]:
+             c(27.051312, 24.258159, 36.597078, 7.321525)
+       , b32nx = ## R-devel 2017-09-18; [florence, Fedora 24 Linux]:
+             c(27.053964, 24.275286, 36.58682,  7.3213653)
+       , b32Win = ## R-devel 2017-09-17, i386-w64-mingw32/i386, W.Server 2008 R2..
+             c(27.05234,  24.264936, 36.593554, 7.3214448)
+         ## for now
+     )
+ )
> ## Average number of decimal digits agreement :
> lapply(cfO.Ts, function(cc) round(-log10(apply(cc - rowMeans(cc), 1, sd)), 2))
$stdE.T
[1] 3.13 2.34 2.62 3.05 2.49 3.29

$stdDev
[1] 2.87 2.06 2.28 4.10

> ## $ stdE.T: num [1:6] 3.13 2.34 2.62 3.05 2.49 3.29
> ## $ stdDev: num [1:4] 2.87 2.06 2.28 4.1
> ## Pairwise distances (formatted, easier to read off):
> round(dist(1000 * t(cfO.Ts[["stdE.T"]])), 1)
        b64nx b32nx b32Win1
b32nx     4.6              
b32Win1   1.7   2.9        
b32Win   10.2  13.9    11.5
> ##         b64nx b32nx b32Win1
> ## b32nx     4.6
> ## b32Win1   1.7   2.9
> ## b32Win   10.2  13.9    11.5
> round(dist(1000 * t(cfO.Ts[["stdDev"]])), 1)
       b64nx b32nx
b32nx   20.1      
b32Win   7.7  12.5
> ##        b64nx b32nx
> ## b32nx   20.1
> ## b32Win   7.7  12.5
> 
> cName <- (if(is64bit) "b64nx"
+           else if(.Platform$OS.type == "Windows") {
+               if(grepl("Server 2008 R2", win.version(), fixed=TRUE))
+                   "b32Win1"
+               else
+                   "b32Win"
+           }
+           else "b32nx" ## 32-bit, non-Windows
+ )
> 
> cfO.T <- array(cfO.Ts[["stdE.T"]][, cName], dim = 3:2,
+                dimnames = list(c("Asym", "xmid", "scal"),
+                                c("Std.Error", "t-value")))
> vcSD <- setNames(cfO.Ts[["stdDev"]][, switch(cName, b64nx=, b32nx=, b32Win=cName,
+                                              b32Win1 = "b32Win")],
+ 		 c("Asym", "xmid", "scal", "Residual"))
> stopifnot(
+     identical(cfO[,"Value"], fixef(nfm)),
+     all.equal(cfO[,c("Std.Error", "t-value")], cfO.T, tol = 3e-4)
+    ,
+     cfO[,"DF"] == 28,
+     all.equal(vc[,"Variance"], vc[,"StdDev"]^2, tol= 5e-7)
+    ,
+     all.equal(vc[,"StdDev"], vcSD, tol = 6e-4) # 3.5e-4 (R 3.0.3, 32b)
+    ,
+     all.equal(unname(vc[2:3, 3:4]), # "Corr"
+               rbind(c(-0.3273, NA),
+ 		    c(-0.9920, 0.4430)), tol = 2e-3)# ~ 2e-4 / 8e-4
+ )
> 
> ## Confirm  predict(*, newdata=.)  works
> (n <- nrow(Orange)) # 35
[1] 35
> set.seed(17)
> newOr <- within(Orange[sample(n, 64, replace=TRUE), ],
+ 		age <- round(jitter(age, amount = 50)))
> fit.v <- predict(nfm, newdata = newOr)
> resiv <- newOr$circumference - fit.v
> res.T <- c(48, 115, 74, 15, 44, -94, 47, -51, 20, -52, -16, 12, -135,
+            -85, 136, 100, 24, 181, -88, -102, -26, 52, -148, 8, -83, 73,
+            -27, -34, 91, 42, 34, -8, 0, 83, 84, -90, -123, 94, -157, -11,
+            56, -164, -28, 72, 15, 148, 95, -122, 169, 84, -19, -124, 45,
+            -66, -10, 119, -110, -43, 12, 94, -108, 45, 48, 46)
> if(!all((res10 <- round(10 * as.vector(resiv))) == res.T)) {
+     iD <- which(res10 != res.T)
+     cat("Differing rounded residuals, at indices", paste(iD, collapse=", "),
+         "; with values:\n")
+     print(cbind(resiv, res10, res.T)[iD,])
+ }
Differing rounded residuals, at indices 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64 ; with values:
            resiv res10 res.T
5  -7.80637375349   -78    48
5  -9.88968031504   -99   115
4   5.45062832541    55    74
1  -1.17270182776   -12    15
3   3.50785013078    35    44
2  16.94525817530   169   -94
1   5.06734984329    51    47
5 -11.81777393963  -118   -51
3   4.41378942394    44    20
1 -12.27849414572  -123   -52
4   5.45118524655    55   -16
1  -0.47365189119    -5    12
3  -0.63424867363    -6  -135
3   2.42351393340    24   -85
3  -4.94391533691   -49   136
5  -0.01173297506     0   100
3  -9.67310713417   -97    24
2   2.35845187886    24   181
5   4.30177111291    43   -88
5  -6.36987138016   -64  -102
1  -2.88945335963   -29   -26
2   2.76771984495    28    52
4 -12.89031524032  -129  -148
5   0.96815593400    10     8
3 -10.75820893721  -108   -83
4   4.21827775670    42    73
5   2.42317531900    24   -27
1 -12.14153158288  -121   -34
2   3.88930989099    39    91
1 -12.14153158288  -121    42
4  -6.30155932735   -63    34
5  13.48856308915   135    -8
5  -2.85495871969   -29     0
3   0.64626890836     6    83
3   5.33115909109    53    84
2  12.77587248103   128   -90
2  -2.33622889212   -23  -123
2   6.50192346996    65    94
4   2.62587127375    26  -157
2   4.34291653867    43   -11
5  -5.50752441170   -55    56
2   9.07137935408    91  -164
2  -1.98596665226   -20   -28
3  -7.71514540737   -77    72
2  -2.18648297463   -22    15
3   6.98870548423    70   148
4  -0.75726957874    -8    95
1   0.47740214997     5  -122
3   8.12497395130    81   169
2  11.15244565829   112    84
1   2.25637555755    23   -19
5   1.62484954681    16  -124
3  -5.38607591535   -54    45
2   3.91563689511    39   -66
2  -9.73278988230   -97   -10
3   0.38225220955     4   119
1   6.27016377336    63  -110
5  -8.59890078858   -86   -43
2  -1.95874356135   -20    12
2   9.95474969489   100    94
5 -11.48952740555  -115  -108
5  14.84456592799   148    45
2   3.96806125495    40    48
1   2.34872386790    23    46
> ## -> indices  14 [64-bit]  or  27 [32-bit], respectively
> 
> 
> ## [Bug 16715] New: nlme: unable to use predict and augPredict ..
> ## Date: 17 Feb 2016 -- part 2 -- predict():
> ##
> ## Comment 4 daveauty@gmail.com 2016-03-08 -- modified by MM --
> 
> ## simulate density data then fit Michaelis-Menten equation of density as
> ## function of ring age. TreeIDs grouped by SP (spacing)
> set.seed(1)
> df <- data.frame(SP = rep(LETTERS[1:5], 60),
+ 		 expand.grid(TreeID = factor(1:12),
+                              age = seq(2, 50, 2)),
+                  stringsAsFactors = TRUE)
> df[,"dens"] <- with(df, (runif(1,10,20)*age)/(runif(1,9,10)+age)) + rnorm(25, 0, 1)
> str(df)
'data.frame':	300 obs. of  4 variables:
 $ SP    : Factor w/ 5 levels "A","B","C","D",..: 1 2 3 4 5 1 2 3 4 5 ...
 $ TreeID: Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ age   : num  2 2 2 2 2 2 2 2 2 2 ...
 $ dens  : num  2.41 1.39 3.82 2.56 1.41 ...
> ## 'data.frame':	300 obs. of  4 variables:
> ##  $ SP    : Factor w/ 5 levels "A","B","C","D",..: 1 2 3 4 5 1 2 3 4 5 ...
> ##  $ TreeID: Factor w/ 12 levels "1","2","3","4",..: 1 2 3 4 5 6 7 8 9 10 ...
> ##  $ age   : num  2 2 2 2 2 2 2 2 2 2 ...
> ##  $ dens  : num  2.41 1.39 3.82 2.56 1.41 ...
> 
> ## mixed-effects model
> fit1 <- nlme(dens ~ a*age/(b+age),
+ 	     fixed = a+b ~ 1, random= a ~ 1|TreeID,
+ 	     start = c(a=15, b=5), data=df)
> summary(fit1)
Nonlinear mixed-effects model fit by maximum likelihood
  Model: dens ~ a * age/(b + age) 
 Data: df 
          AIC         BIC       logLik
  808.4069212 823.2220511 -400.2034606

Random effects:
 Formula: a ~ 1 | TreeID
                      a     Residual
StdDev: 2.771601524e-05 0.9185793399

Fixed effects: a + b ~ 1 
        Value    Std.Error  DF     t-value p-value
a 12.75812579 0.1914871807 287 66.62652686       0
b  8.92120623 0.4906380783 287 18.18286559       0
 Correlation: 
  a    
b 0.918

Standardized Within-Group Residuals:
          Min            Q1           Med            Q3           Max 
-2.6420672739 -0.2833115747  0.2220191306  0.6630992104  1.6161028861 

Number of Observations: 300
Number of Groups: 12 
> fit1R <- update(fit1, method = "REML")
> ## allow fixed effects parameters to vary by 'SP':
> fit2 <- update(fit1, fixed = list(a ~ SP, b ~ SP),
+                start = c(a = rep(14, 5), b = rep(4, 5)))
> summary(fit2)
Nonlinear mixed-effects model fit by maximum likelihood
  Model: dens ~ a * age/(b + age) 
 Data: df 
         AIC         BIC      logLik
  799.210016 843.6554057 -387.605008

Random effects:
 Formula: a ~ 1 | TreeID
          a.(Intercept)     Residual
StdDev: 2.877033962e-05 0.8808025132

Fixed effects: list(a ~ SP, b ~ SP) 
                     Value    Std.Error  DF      t-value p-value
a.(Intercept) 12.903085400 0.4091007708 279 31.540115101  0.0000
a.SPB         -0.170084498 0.5947105382 279 -0.285995434  0.7751
a.SPC         -0.643219766 0.5919816319 279 -1.086553588  0.2782
a.SPD          0.095662373 0.5731020424 279  0.166920315  0.8676
a.SPE         -0.008338950 0.5812270561 279 -0.014347147  0.9886
b.(Intercept)  8.646803988 1.0165457677 279  8.506064619  0.0000
b.SPB          0.686459331 1.5205833097 279  0.451444736  0.6520
b.SPC          0.672297887 1.5446580653 279  0.435240589  0.6637
b.SPD         -0.159835843 1.4178921645 279 -0.112727785  0.9103
b.SPE          0.221183982 1.4603631221 279  0.151458209  0.8797
 Correlation: 
              a.(In) a.SPB  a.SPC  a.SPD  a.SPE  b.(In) b.SPB  b.SPC  b.SPD 
a.SPB         -0.688                                                        
a.SPC         -0.691  0.475                                                 
a.SPD         -0.714  0.491  0.493                                          
a.SPE         -0.704  0.484  0.486  0.502                                   
b.(Intercept)  0.916 -0.630 -0.633 -0.654 -0.645                            
b.SPB         -0.612  0.919  0.423  0.437  0.431 -0.669                     
b.SPC         -0.603  0.415  0.918  0.430  0.424 -0.658  0.440              
b.SPD         -0.657  0.452  0.454  0.915  0.462 -0.717  0.479  0.472       
b.SPE         -0.637  0.438  0.441  0.455  0.917 -0.696  0.465  0.458  0.499

Standardized Within-Group Residuals:
           Min             Q1            Med             Q3            Max 
-2.39676501852 -0.45686320644  0.04081417954  0.74467663361  2.17580169160 

Number of Observations: 300
Number of Groups: 12 
> 
> ## make new data for predictions
> newdat <- expand.grid(SP = LETTERS[1:5], age = seq(1, 50, 1))
> n.pred1 <- predict(fit1, newdat, level=0) # works fine
> n.pred2 <- predict(fit2, newdat, level=0)
> ## in nlme 3.1-124, throws the error:
> ## Error in eval(expr, envir, enclos) : object 'SP' not found
> 
> ## New data with  never-yet observed levels of a random effect -- PR#16614 :
> set.seed(47)
> newD <- expand.grid(SP = LETTERS[2:4], age = runif(16, 1,50),
+                     TreeID = sample(c(sample(1:12, 7), 100:102)))
> n1prD0 <- predict(fit1, newD, level=0)
> n2prD0 <- predict(fit2, newD, level=0)
> n1prD1 <- predict(fit1, newD, level=1)   # failed in nlme <= 3.1-126
> n2prD1 <- predict(fit2, newD, level=1)   # ditto
> (n1prD01 <- predict(fit1, newD, level=0:1))#  "
    TreeID predict.fixed predict.TreeID
97       5  10.788697605   10.788697606
98       5  10.788697605   10.788697606
99       5  10.788697605   10.788697606
100      5   8.728189213    8.728189213
101      5   8.728189213    8.728189213
102      5   8.728189213    8.728189213
103      5  10.348507082   10.348507083
104      5  10.348507082   10.348507083
105      5  10.348507082   10.348507083
106      5  10.491889155   10.491889155
107      5  10.491889155   10.491889155
108      5  10.491889155   10.491889155
109      5   9.764878647    9.764878647
110      5   9.764878647    9.764878647
111      5   9.764878647    9.764878647
112      5  10.159568882   10.159568882
113      5  10.159568882   10.159568882
114      5  10.159568882   10.159568882
115      5   8.831372618    8.831372618
116      5   8.831372618    8.831372618
117      5   8.831372618    8.831372618
118      5   9.298569649    9.298569649
119      5   9.298569649    9.298569649
120      5   9.298569649    9.298569649
121      5   9.643529914    9.643529915
122      5   9.643529914    9.643529915
123      5   9.643529914    9.643529915
124      5  10.697735080   10.697735081
125      5  10.697735080   10.697735081
126      5  10.697735080   10.697735081
127      5   5.951768072    5.951768072
128      5   5.951768072    5.951768072
129      5   5.951768072    5.951768072
130      5  10.189950687   10.189950687
131      5  10.189950687   10.189950687
132      5  10.189950687   10.189950687
133      5   6.388445579    6.388445579
134      5   6.388445579    6.388445579
135      5   6.388445579    6.388445579
136      5   9.861056861    9.861056862
137      5   9.861056861    9.861056862
138      5   9.861056861    9.861056862
139      5   9.479675711    9.479675711
140      5   9.479675711    9.479675711
141      5   9.479675711    9.479675711
142      5  10.654979642   10.654979642
143      5  10.654979642   10.654979642
144      5  10.654979642   10.654979642
241     11  10.788697605   10.788697605
242     11  10.788697605   10.788697605
243     11  10.788697605   10.788697605
244     11   8.728189213    8.728189213
245     11   8.728189213    8.728189213
246     11   8.728189213    8.728189213
247     11  10.348507082   10.348507083
248     11  10.348507082   10.348507083
249     11  10.348507082   10.348507083
250     11  10.491889155   10.491889155
251     11  10.491889155   10.491889155
252     11  10.491889155   10.491889155
253     11   9.764878647    9.764878647
254     11   9.764878647    9.764878647
255     11   9.764878647    9.764878647
256     11  10.159568882   10.159568882
257     11  10.159568882   10.159568882
258     11  10.159568882   10.159568882
259     11   8.831372618    8.831372618
260     11   8.831372618    8.831372618
261     11   8.831372618    8.831372618
262     11   9.298569649    9.298569649
263     11   9.298569649    9.298569649
264     11   9.298569649    9.298569649
265     11   9.643529914    9.643529914
266     11   9.643529914    9.643529914
267     11   9.643529914    9.643529914
268     11  10.697735080   10.697735080
269     11  10.697735080   10.697735080
270     11  10.697735080   10.697735080
271     11   5.951768072    5.951768072
272     11   5.951768072    5.951768072
273     11   5.951768072    5.951768072
274     11  10.189950687   10.189950687
275     11  10.189950687   10.189950687
276     11  10.189950687   10.189950687
277     11   6.388445579    6.388445579
278     11   6.388445579    6.388445579
279     11   6.388445579    6.388445579
280     11   9.861056861    9.861056861
281     11   9.861056861    9.861056861
282     11   9.861056861    9.861056861
283     11   9.479675711    9.479675711
284     11   9.479675711    9.479675711
285     11   9.479675711    9.479675711
286     11  10.654979642   10.654979642
287     11  10.654979642   10.654979642
288     11  10.654979642   10.654979642
337    100  10.788697605             NA
338    100  10.788697605             NA
339    100  10.788697605             NA
340    100   8.728189213             NA
341    100   8.728189213             NA
342    100   8.728189213             NA
343    100  10.348507082             NA
344    100  10.348507082             NA
345    100  10.348507082             NA
346    100  10.491889155             NA
347    100  10.491889155             NA
348    100  10.491889155             NA
349    100   9.764878647             NA
350    100   9.764878647             NA
351    100   9.764878647             NA
352    100  10.159568882             NA
353    100  10.159568882             NA
354    100  10.159568882             NA
355    100   8.831372618             NA
356    100   8.831372618             NA
357    100   8.831372618             NA
358    100   9.298569649             NA
359    100   9.298569649             NA
360    100   9.298569649             NA
361    100   9.643529914             NA
362    100   9.643529914             NA
363    100   9.643529914             NA
364    100  10.697735080             NA
365    100  10.697735080             NA
366    100  10.697735080             NA
367    100   5.951768072             NA
368    100   5.951768072             NA
369    100   5.951768072             NA
370    100  10.189950687             NA
371    100  10.189950687             NA
372    100  10.189950687             NA
373    100   6.388445579             NA
374    100   6.388445579             NA
375    100   6.388445579             NA
376    100   9.861056861             NA
377    100   9.861056861             NA
378    100   9.861056861             NA
379    100   9.479675711             NA
380    100   9.479675711             NA
381    100   9.479675711             NA
382    100  10.654979642             NA
383    100  10.654979642             NA
384    100  10.654979642             NA
49       4  10.788697605   10.788697606
50       4  10.788697605   10.788697606
51       4  10.788697605   10.788697606
52       4   8.728189213    8.728189213
53       4   8.728189213    8.728189213
54       4   8.728189213    8.728189213
55       4  10.348507082   10.348507083
56       4  10.348507082   10.348507083
57       4  10.348507082   10.348507083
58       4  10.491889155   10.491889155
59       4  10.491889155   10.491889155
60       4  10.491889155   10.491889155
61       4   9.764878647    9.764878647
62       4   9.764878647    9.764878647
63       4   9.764878647    9.764878647
64       4  10.159568882   10.159568882
65       4  10.159568882   10.159568882
66       4  10.159568882   10.159568882
67       4   8.831372618    8.831372618
68       4   8.831372618    8.831372618
69       4   8.831372618    8.831372618
70       4   9.298569649    9.298569649
71       4   9.298569649    9.298569649
72       4   9.298569649    9.298569649
73       4   9.643529914    9.643529914
74       4   9.643529914    9.643529914
75       4   9.643529914    9.643529914
76       4  10.697735080   10.697735080
77       4  10.697735080   10.697735080
78       4  10.697735080   10.697735080
79       4   5.951768072    5.951768072
80       4   5.951768072    5.951768072
81       4   5.951768072    5.951768072
82       4  10.189950687   10.189950687
83       4  10.189950687   10.189950687
84       4  10.189950687   10.189950687
85       4   6.388445579    6.388445579
86       4   6.388445579    6.388445579
87       4   6.388445579    6.388445579
88       4   9.861056861    9.861056861
89       4   9.861056861    9.861056861
90       4   9.861056861    9.861056861
91       4   9.479675711    9.479675711
92       4   9.479675711    9.479675711
93       4   9.479675711    9.479675711
94       4  10.654979642   10.654979642
95       4  10.654979642   10.654979642
96       4  10.654979642   10.654979642
1        2  10.788697605   10.788697606
2        2  10.788697605   10.788697606
3        2  10.788697605   10.788697606
4        2   8.728189213    8.728189214
5        2   8.728189213    8.728189214
6        2   8.728189213    8.728189214
7        2  10.348507082   10.348507083
8        2  10.348507082   10.348507083
9        2  10.348507082   10.348507083
10       2  10.491889155   10.491889155
11       2  10.491889155   10.491889155
12       2  10.491889155   10.491889155
13       2   9.764878647    9.764878648
14       2   9.764878647    9.764878648
15       2   9.764878647    9.764878648
16       2  10.159568882   10.159568883
17       2  10.159568882   10.159568883
18       2  10.159568882   10.159568883
19       2   8.831372618    8.831372619
20       2   8.831372618    8.831372619
21       2   8.831372618    8.831372619
22       2   9.298569649    9.298569650
23       2   9.298569649    9.298569650
24       2   9.298569649    9.298569650
25       2   9.643529914    9.643529915
26       2   9.643529914    9.643529915
27       2   9.643529914    9.643529915
28       2  10.697735080   10.697735081
29       2  10.697735080   10.697735081
30       2  10.697735080   10.697735081
31       2   5.951768072    5.951768072
32       2   5.951768072    5.951768072
33       2   5.951768072    5.951768072
34       2  10.189950687   10.189950688
35       2  10.189950687   10.189950688
36       2  10.189950687   10.189950688
37       2   6.388445579    6.388445579
38       2   6.388445579    6.388445579
39       2   6.388445579    6.388445579
40       2   9.861056861    9.861056862
41       2   9.861056861    9.861056862
42       2   9.861056861    9.861056862
43       2   9.479675711    9.479675712
44       2   9.479675711    9.479675712
45       2   9.479675711    9.479675712
46       2  10.654979642   10.654979643
47       2  10.654979642   10.654979643
48       2  10.654979642   10.654979643
289     12  10.788697605   10.788697606
290     12  10.788697605   10.788697606
291     12  10.788697605   10.788697606
292     12   8.728189213    8.728189213
293     12   8.728189213    8.728189213
294     12   8.728189213    8.728189213
295     12  10.348507082   10.348507083
296     12  10.348507082   10.348507083
297     12  10.348507082   10.348507083
298     12  10.491889155   10.491889155
299     12  10.491889155   10.491889155
300     12  10.491889155   10.491889155
301     12   9.764878647    9.764878647
302     12   9.764878647    9.764878647
303     12   9.764878647    9.764878647
304     12  10.159568882   10.159568882
305     12  10.159568882   10.159568882
306     12  10.159568882   10.159568882
307     12   8.831372618    8.831372618
308     12   8.831372618    8.831372618
309     12   8.831372618    8.831372618
310     12   9.298569649    9.298569649
311     12   9.298569649    9.298569649
312     12   9.298569649    9.298569649
313     12   9.643529914    9.643529915
314     12   9.643529914    9.643529915
315     12   9.643529914    9.643529915
316     12  10.697735080   10.697735081
317     12  10.697735080   10.697735081
318     12  10.697735080   10.697735081
319     12   5.951768072    5.951768072
320     12   5.951768072    5.951768072
321     12   5.951768072    5.951768072
322     12  10.189950687   10.189950687
323     12  10.189950687   10.189950687
324     12  10.189950687   10.189950687
325     12   6.388445579    6.388445579
326     12   6.388445579    6.388445579
327     12   6.388445579    6.388445579
328     12   9.861056861    9.861056862
329     12   9.861056861    9.861056862
330     12   9.861056861    9.861056862
331     12   9.479675711    9.479675711
332     12   9.479675711    9.479675711
333     12   9.479675711    9.479675711
334     12  10.654979642   10.654979642
335     12  10.654979642   10.654979642
336     12  10.654979642   10.654979642
145      8  10.788697605   10.788697604
146      8  10.788697605   10.788697604
147      8  10.788697605   10.788697604
148      8   8.728189213    8.728189212
149      8   8.728189213    8.728189212
150      8   8.728189213    8.728189212
151      8  10.348507082   10.348507082
152      8  10.348507082   10.348507082
153      8  10.348507082   10.348507082
154      8  10.491889155   10.491889154
155      8  10.491889155   10.491889154
156      8  10.491889155   10.491889154
157      8   9.764878647    9.764878646
158      8   9.764878647    9.764878646
159      8   9.764878647    9.764878646
160      8  10.159568882   10.159568881
161      8  10.159568882   10.159568881
162      8  10.159568882   10.159568881
163      8   8.831372618    8.831372617
164      8   8.831372618    8.831372617
165      8   8.831372618    8.831372617
166      8   9.298569649    9.298569648
167      8   9.298569649    9.298569648
168      8   9.298569649    9.298569648
169      8   9.643529914    9.643529914
170      8   9.643529914    9.643529914
171      8   9.643529914    9.643529914
172      8  10.697735080   10.697735079
173      8  10.697735080   10.697735079
174      8  10.697735080   10.697735079
175      8   5.951768072    5.951768071
176      8   5.951768072    5.951768071
177      8   5.951768072    5.951768071
178      8  10.189950687   10.189950686
179      8  10.189950687   10.189950686
180      8  10.189950687   10.189950686
181      8   6.388445579    6.388445578
182      8   6.388445579    6.388445578
183      8   6.388445579    6.388445578
184      8   9.861056861    9.861056861
185      8   9.861056861    9.861056861
186      8   9.861056861    9.861056861
187      8   9.479675711    9.479675710
188      8   9.479675711    9.479675710
189      8   9.479675711    9.479675710
190      8  10.654979642   10.654979641
191      8  10.654979642   10.654979641
192      8  10.654979642   10.654979641
433    102  10.788697605             NA
434    102  10.788697605             NA
435    102  10.788697605             NA
436    102   8.728189213             NA
437    102   8.728189213             NA
438    102   8.728189213             NA
439    102  10.348507082             NA
440    102  10.348507082             NA
441    102  10.348507082             NA
442    102  10.491889155             NA
443    102  10.491889155             NA
444    102  10.491889155             NA
445    102   9.764878647             NA
446    102   9.764878647             NA
447    102   9.764878647             NA
448    102  10.159568882             NA
449    102  10.159568882             NA
450    102  10.159568882             NA
451    102   8.831372618             NA
452    102   8.831372618             NA
453    102   8.831372618             NA
454    102   9.298569649             NA
455    102   9.298569649             NA
456    102   9.298569649             NA
457    102   9.643529914             NA
458    102   9.643529914             NA
459    102   9.643529914             NA
460    102  10.697735080             NA
461    102  10.697735080             NA
462    102  10.697735080             NA
463    102   5.951768072             NA
464    102   5.951768072             NA
465    102   5.951768072             NA
466    102  10.189950687             NA
467    102  10.189950687             NA
468    102  10.189950687             NA
469    102   6.388445579             NA
470    102   6.388445579             NA
471    102   6.388445579             NA
472    102   9.861056861             NA
473    102   9.861056861             NA
474    102   9.861056861             NA
475    102   9.479675711             NA
476    102   9.479675711             NA
477    102   9.479675711             NA
478    102  10.654979642             NA
479    102  10.654979642             NA
480    102  10.654979642             NA
385    101  10.788697605             NA
386    101  10.788697605             NA
387    101  10.788697605             NA
388    101   8.728189213             NA
389    101   8.728189213             NA
390    101   8.728189213             NA
391    101  10.348507082             NA
392    101  10.348507082             NA
393    101  10.348507082             NA
394    101  10.491889155             NA
395    101  10.491889155             NA
396    101  10.491889155             NA
397    101   9.764878647             NA
398    101   9.764878647             NA
399    101   9.764878647             NA
400    101  10.159568882             NA
401    101  10.159568882             NA
402    101  10.159568882             NA
403    101   8.831372618             NA
404    101   8.831372618             NA
405    101   8.831372618             NA
406    101   9.298569649             NA
407    101   9.298569649             NA
408    101   9.298569649             NA
409    101   9.643529914             NA
410    101   9.643529914             NA
411    101   9.643529914             NA
412    101  10.697735080             NA
413    101  10.697735080             NA
414    101  10.697735080             NA
415    101   5.951768072             NA
416    101   5.951768072             NA
417    101   5.951768072             NA
418    101  10.189950687             NA
419    101  10.189950687             NA
420    101  10.189950687             NA
421    101   6.388445579             NA
422    101   6.388445579             NA
423    101   6.388445579             NA
424    101   9.861056861             NA
425    101   9.861056861             NA
426    101   9.861056861             NA
427    101   9.479675711             NA
428    101   9.479675711             NA
429    101   9.479675711             NA
430    101  10.654979642             NA
431    101  10.654979642             NA
432    101  10.654979642             NA
193      9  10.788697605   10.788697605
194      9  10.788697605   10.788697605
195      9  10.788697605   10.788697605
196      9   8.728189213    8.728189212
197      9   8.728189213    8.728189212
198      9   8.728189213    8.728189212
199      9  10.348507082   10.348507082
200      9  10.348507082   10.348507082
201      9  10.348507082   10.348507082
202      9  10.491889155   10.491889154
203      9  10.491889155   10.491889154
204      9  10.491889155   10.491889154
205      9   9.764878647    9.764878646
206      9   9.764878647    9.764878646
207      9   9.764878647    9.764878646
208      9  10.159568882   10.159568881
209      9  10.159568882   10.159568881
210      9  10.159568882   10.159568881
211      9   8.831372618    8.831372617
212      9   8.831372618    8.831372617
213      9   8.831372618    8.831372617
214      9   9.298569649    9.298569649
215      9   9.298569649    9.298569649
216      9   9.298569649    9.298569649
217      9   9.643529914    9.643529914
218      9   9.643529914    9.643529914
219      9   9.643529914    9.643529914
220      9  10.697735080   10.697735080
221      9  10.697735080   10.697735080
222      9  10.697735080   10.697735080
223      9   5.951768072    5.951768071
224      9   5.951768072    5.951768071
225      9   5.951768072    5.951768071
226      9  10.189950687   10.189950687
227      9  10.189950687   10.189950687
228      9  10.189950687   10.189950687
229      9   6.388445579    6.388445578
230      9   6.388445579    6.388445578
231      9   6.388445579    6.388445578
232      9   9.861056861    9.861056861
233      9   9.861056861    9.861056861
234      9   9.861056861    9.861056861
235      9   9.479675711    9.479675710
236      9   9.479675711    9.479675710
237      9   9.479675711    9.479675710
238      9  10.654979642   10.654979641
239      9  10.654979642   10.654979641
240      9  10.654979642   10.654979641
> (n2prD01 <- predict(fit2, newD, level=0:1))#  "
    TreeID predict.fixed predict.TreeID
97       5  10.691223172   10.691223173
98       5  10.296461854   10.296461855
99       5  11.075393503   11.075393504
100      5   8.585737596    8.585737596
101      5   8.270794573    8.270794574
102      5   9.031667476    9.031667477
103      5  10.238808350   10.238808351
104      5   9.861283702    9.861283702
105      5  10.641512297   10.641512298
106      5  10.386015150   10.386015151
107      5  10.002887183   10.002887184
108      5  10.783000685   10.783000685
109      5   9.641171765    9.641171766
110      5   9.286344670    9.286344670
111      5  10.063976117   10.063976117
112      5  10.045061409   10.045061410
113      5   9.674904022    9.674904022
114      5  10.454830701   10.454830701
115      5   8.690436648    8.690436649
116      5   8.371548545    8.371548546
117      5   9.134786355    9.134786356
118      5   9.165463082    9.165463082
119      5   8.828644298    8.828644299
120      5   9.600661595    9.600661596
121      5   9.517224050    9.517224050
122      5   9.167094090    9.167094090
123      5   9.943567233    9.943567233
124      5  10.597617251   10.597617251
125      5  10.206426100   10.206426101
126      5  10.985855163   10.985855164
127      5   5.797197265    5.797197265
128      5   5.586401037    5.586401038
129      5   6.225686448    6.225686448
130      5  10.076198755   10.076198755
131      5   9.704857945    9.704857945
132      5  10.484867976   10.484867977
133      5   6.232149551    6.232149551
134      5   6.005226187    6.005226187
135      5   6.671050821    6.671050821
136      5   9.739486434    9.739486435
137      5   9.380931090    9.380931091
138      5  10.159329342   10.159329343
139      5   9.350031285    9.350031285
140      5   9.006231696    9.006231696
141      5   9.780802933    9.780802934
142      5  10.553640466   10.553640466
143      5  10.164125913   10.164125914
144      5  10.943747495   10.943747496
241     11  10.691223172   10.691223172
242     11  10.296461854   10.296461854
243     11  11.075393503   11.075393503
244     11   8.585737596    8.585737596
245     11   8.270794573    8.270794573
246     11   9.031667476    9.031667476
247     11  10.238808350   10.238808350
248     11   9.861283702    9.861283702
249     11  10.641512297   10.641512297
250     11  10.386015150   10.386015150
251     11  10.002887183   10.002887183
252     11  10.783000685   10.783000685
253     11   9.641171765    9.641171765
254     11   9.286344670    9.286344670
255     11  10.063976117   10.063976116
256     11  10.045061409   10.045061409
257     11   9.674904022    9.674904022
258     11  10.454830701   10.454830701
259     11   8.690436648    8.690436648
260     11   8.371548545    8.371548545
261     11   9.134786355    9.134786355
262     11   9.165463082    9.165463082
263     11   8.828644298    8.828644298
264     11   9.600661595    9.600661595
265     11   9.517224050    9.517224050
266     11   9.167094090    9.167094090
267     11   9.943567233    9.943567233
268     11  10.597617251   10.597617251
269     11  10.206426100   10.206426100
270     11  10.985855163   10.985855163
271     11   5.797197265    5.797197264
272     11   5.586401037    5.586401037
273     11   6.225686448    6.225686448
274     11  10.076198755   10.076198755
275     11   9.704857945    9.704857945
276     11  10.484867976   10.484867976
277     11   6.232149551    6.232149551
278     11   6.005226187    6.005226187
279     11   6.671050821    6.671050821
280     11   9.739486434    9.739486434
281     11   9.380931090    9.380931090
282     11  10.159329342   10.159329342
283     11   9.350031285    9.350031285
284     11   9.006231696    9.006231696
285     11   9.780802933    9.780802933
286     11  10.553640466   10.553640466
287     11  10.164125913   10.164125913
288     11  10.943747495   10.943747495
337    100  10.691223172             NA
338    100  10.296461854             NA
339    100  11.075393503             NA
340    100   8.585737596             NA
341    100   8.270794573             NA
342    100   9.031667476             NA
343    100  10.238808350             NA
344    100   9.861283702             NA
345    100  10.641512297             NA
346    100  10.386015150             NA
347    100  10.002887183             NA
348    100  10.783000685             NA
349    100   9.641171765             NA
350    100   9.286344670             NA
351    100  10.063976117             NA
352    100  10.045061409             NA
353    100   9.674904022             NA
354    100  10.454830701             NA
355    100   8.690436648             NA
356    100   8.371548545             NA
357    100   9.134786355             NA
358    100   9.165463082             NA
359    100   8.828644298             NA
360    100   9.600661595             NA
361    100   9.517224050             NA
362    100   9.167094090             NA
363    100   9.943567233             NA
364    100  10.597617251             NA
365    100  10.206426100             NA
366    100  10.985855163             NA
367    100   5.797197265             NA
368    100   5.586401037             NA
369    100   6.225686448             NA
370    100  10.076198755             NA
371    100   9.704857945             NA
372    100  10.484867976             NA
373    100   6.232149551             NA
374    100   6.005226187             NA
375    100   6.671050821             NA
376    100   9.739486434             NA
377    100   9.380931090             NA
378    100  10.159329342             NA
379    100   9.350031285             NA
380    100   9.006231696             NA
381    100   9.780802933             NA
382    100  10.553640466             NA
383    100  10.164125913             NA
384    100  10.943747495             NA
49       4  10.691223172   10.691223173
50       4  10.296461854   10.296461855
51       4  11.075393503   11.075393504
52       4   8.585737596    8.585737596
53       4   8.270794573    8.270794573
54       4   9.031667476    9.031667477
55       4  10.238808350   10.238808350
56       4   9.861283702    9.861283702
57       4  10.641512297   10.641512297
58       4  10.386015150   10.386015151
59       4  10.002887183   10.002887184
60       4  10.783000685   10.783000685
61       4   9.641171765    9.641171765
62       4   9.286344670    9.286344670
63       4  10.063976117   10.063976117
64       4  10.045061409   10.045061410
65       4   9.674904022    9.674904022
66       4  10.454830701   10.454830701
67       4   8.690436648    8.690436649
68       4   8.371548545    8.371548546
69       4   9.134786355    9.134786356
70       4   9.165463082    9.165463082
71       4   8.828644298    8.828644299
72       4   9.600661595    9.600661596
73       4   9.517224050    9.517224050
74       4   9.167094090    9.167094090
75       4   9.943567233    9.943567233
76       4  10.597617251   10.597617251
77       4  10.206426100   10.206426100
78       4  10.985855163   10.985855164
79       4   5.797197265    5.797197265
80       4   5.586401037    5.586401038
81       4   6.225686448    6.225686448
82       4  10.076198755   10.076198755
83       4   9.704857945    9.704857945
84       4  10.484867976   10.484867977
85       4   6.232149551    6.232149551
86       4   6.005226187    6.005226187
87       4   6.671050821    6.671050821
88       4   9.739486434    9.739486435
89       4   9.380931090    9.380931091
90       4  10.159329342   10.159329342
91       4   9.350031285    9.350031285
92       4   9.006231696    9.006231696
93       4   9.780802933    9.780802934
94       4  10.553640466   10.553640466
95       4  10.164125913   10.164125914
96       4  10.943747495   10.943747495
1        2  10.691223172   10.691223174
2        2  10.296461854   10.296461856
3        2  11.075393503   11.075393505
4        2   8.585737596    8.585737597
5        2   8.270794573    8.270794574
6        2   9.031667476    9.031667477
7        2  10.238808350   10.238808351
8        2   9.861283702    9.861283703
9        2  10.641512297   10.641512298
10       2  10.386015150   10.386015152
11       2  10.002887183   10.002887184
12       2  10.783000685   10.783000686
13       2   9.641171765    9.641171766
14       2   9.286344670    9.286344671
15       2  10.063976117   10.063976118
16       2  10.045061409   10.045061411
17       2   9.674904022    9.674904023
18       2  10.454830701   10.454830702
19       2   8.690436648    8.690436649
20       2   8.371548545    8.371548546
21       2   9.134786355    9.134786357
22       2   9.165463082    9.165463083
23       2   8.828644298    8.828644299
24       2   9.600661595    9.600661596
25       2   9.517224050    9.517224051
26       2   9.167094090    9.167094091
27       2   9.943567233    9.943567234
28       2  10.597617251   10.597617252
29       2  10.206426100   10.206426101
30       2  10.985855163   10.985855165
31       2   5.797197265    5.797197265
32       2   5.586401037    5.586401038
33       2   6.225686448    6.225686449
34       2  10.076198755   10.076198756
35       2   9.704857945    9.704857946
36       2  10.484867976   10.484867977
37       2   6.232149551    6.232149551
38       2   6.005226187    6.005226188
39       2   6.671050821    6.671050822
40       2   9.739486434    9.739486436
41       2   9.380931090    9.380931091
42       2  10.159329342   10.159329343
43       2   9.350031285    9.350031286
44       2   9.006231696    9.006231697
45       2   9.780802933    9.780802934
46       2  10.553640466   10.553640467
47       2  10.164125913   10.164125914
48       2  10.943747495   10.943747496
289     12  10.691223172   10.691223173
290     12  10.296461854   10.296461855
291     12  11.075393503   11.075393504
292     12   8.585737596    8.585737596
293     12   8.270794573    8.270794573
294     12   9.031667476    9.031667477
295     12  10.238808350   10.238808350
296     12   9.861283702    9.861283702
297     12  10.641512297   10.641512297
298     12  10.386015150   10.386015151
299     12  10.002887183   10.002887184
300     12  10.783000685   10.783000685
301     12   9.641171765    9.641171765
302     12   9.286344670    9.286344670
303     12  10.063976117   10.063976117
304     12  10.045061409   10.045061410
305     12   9.674904022    9.674904022
306     12  10.454830701   10.454830701
307     12   8.690436648    8.690436649
308     12   8.371548545    8.371548546
309     12   9.134786355    9.134786356
310     12   9.165463082    9.165463082
311     12   8.828644298    8.828644299
312     12   9.600661595    9.600661596
313     12   9.517224050    9.517224050
314     12   9.167094090    9.167094090
315     12   9.943567233    9.943567233
316     12  10.597617251   10.597617251
317     12  10.206426100   10.206426100
318     12  10.985855163   10.985855164
319     12   5.797197265    5.797197265
320     12   5.586401037    5.586401038
321     12   6.225686448    6.225686448
322     12  10.076198755   10.076198755
323     12   9.704857945    9.704857945
324     12  10.484867976   10.484867977
325     12   6.232149551    6.232149551
326     12   6.005226187    6.005226187
327     12   6.671050821    6.671050821
328     12   9.739486434    9.739486435
329     12   9.380931090    9.380931091
330     12  10.159329342   10.159329342
331     12   9.350031285    9.350031285
332     12   9.006231696    9.006231696
333     12   9.780802933    9.780802934
334     12  10.553640466   10.553640466
335     12  10.164125913   10.164125914
336     12  10.943747495   10.943747495
145      8  10.691223172   10.691223171
146      8  10.296461854   10.296461853
147      8  11.075393503   11.075393502
148      8   8.585737596    8.585737595
149      8   8.270794573    8.270794572
150      8   9.031667476    9.031667475
151      8  10.238808350   10.238808349
152      8   9.861283702    9.861283701
153      8  10.641512297   10.641512296
154      8  10.386015150   10.386015149
155      8  10.002887183   10.002887182
156      8  10.783000685   10.783000683
157      8   9.641171765    9.641171764
158      8   9.286344670    9.286344669
159      8  10.063976117   10.063976115
160      8  10.045061409   10.045061408
161      8   9.674904022    9.674904020
162      8  10.454830701   10.454830700
163      8   8.690436648    8.690436647
164      8   8.371548545    8.371548544
165      8   9.134786355    9.134786354
166      8   9.165463082    9.165463081
167      8   8.828644298    8.828644297
168      8   9.600661595    9.600661594
169      8   9.517224050    9.517224049
170      8   9.167094090    9.167094089
171      8   9.943567233    9.943567232
172      8  10.597617251   10.597617250
173      8  10.206426100   10.206426099
174      8  10.985855163   10.985855162
175      8   5.797197265    5.797197264
176      8   5.586401037    5.586401037
177      8   6.225686448    6.225686447
178      8  10.076198755   10.076198754
179      8   9.704857945    9.704857943
180      8  10.484867976   10.484867975
181      8   6.232149551    6.232149550
182      8   6.005226187    6.005226186
183      8   6.671050821    6.671050820
184      8   9.739486434    9.739486433
185      8   9.380931090    9.380931089
186      8  10.159329342   10.159329341
187      8   9.350031285    9.350031284
188      8   9.006231696    9.006231695
189      8   9.780802933    9.780802932
190      8  10.553640466   10.553640465
191      8  10.164125913   10.164125912
192      8  10.943747495   10.943747494
433    102  10.691223172             NA
434    102  10.296461854             NA
435    102  11.075393503             NA
436    102   8.585737596             NA
437    102   8.270794573             NA
438    102   9.031667476             NA
439    102  10.238808350             NA
440    102   9.861283702             NA
441    102  10.641512297             NA
442    102  10.386015150             NA
443    102  10.002887183             NA
444    102  10.783000685             NA
445    102   9.641171765             NA
446    102   9.286344670             NA
447    102  10.063976117             NA
448    102  10.045061409             NA
449    102   9.674904022             NA
450    102  10.454830701             NA
451    102   8.690436648             NA
452    102   8.371548545             NA
453    102   9.134786355             NA
454    102   9.165463082             NA
455    102   8.828644298             NA
456    102   9.600661595             NA
457    102   9.517224050             NA
458    102   9.167094090             NA
459    102   9.943567233             NA
460    102  10.597617251             NA
461    102  10.206426100             NA
462    102  10.985855163             NA
463    102   5.797197265             NA
464    102   5.586401037             NA
465    102   6.225686448             NA
466    102  10.076198755             NA
467    102   9.704857945             NA
468    102  10.484867976             NA
469    102   6.232149551             NA
470    102   6.005226187             NA
471    102   6.671050821             NA
472    102   9.739486434             NA
473    102   9.380931090             NA
474    102  10.159329342             NA
475    102   9.350031285             NA
476    102   9.006231696             NA
477    102   9.780802933             NA
478    102  10.553640466             NA
479    102  10.164125913             NA
480    102  10.943747495             NA
385    101  10.691223172             NA
386    101  10.296461854             NA
387    101  11.075393503             NA
388    101   8.585737596             NA
389    101   8.270794573             NA
390    101   9.031667476             NA
391    101  10.238808350             NA
392    101   9.861283702             NA
393    101  10.641512297             NA
394    101  10.386015150             NA
395    101  10.002887183             NA
396    101  10.783000685             NA
397    101   9.641171765             NA
398    101   9.286344670             NA
399    101  10.063976117             NA
400    101  10.045061409             NA
401    101   9.674904022             NA
402    101  10.454830701             NA
403    101   8.690436648             NA
404    101   8.371548545             NA
405    101   9.134786355             NA
406    101   9.165463082             NA
407    101   8.828644298             NA
408    101   9.600661595             NA
409    101   9.517224050             NA
410    101   9.167094090             NA
411    101   9.943567233             NA
412    101  10.597617251             NA
413    101  10.206426100             NA
414    101  10.985855163             NA
415    101   5.797197265             NA
416    101   5.586401037             NA
417    101   6.225686448             NA
418    101  10.076198755             NA
419    101   9.704857945             NA
420    101  10.484867976             NA
421    101   6.232149551             NA
422    101   6.005226187             NA
423    101   6.671050821             NA
424    101   9.739486434             NA
425    101   9.380931090             NA
426    101  10.159329342             NA
427    101   9.350031285             NA
428    101   9.006231696             NA
429    101   9.780802933             NA
430    101  10.553640466             NA
431    101  10.164125913             NA
432    101  10.943747495             NA
193      9  10.691223172   10.691223172
194      9  10.296461854   10.296461854
195      9  11.075393503   11.075393503
196      9   8.585737596    8.585737595
197      9   8.270794573    8.270794573
198      9   9.031667476    9.031667476
199      9  10.238808350   10.238808350
200      9   9.861283702    9.861283701
201      9  10.641512297   10.641512296
202      9  10.386015150   10.386015150
203      9  10.002887183   10.002887183
204      9  10.783000685   10.783000684
205      9   9.641171765    9.641171765
206      9   9.286344670    9.286344669
207      9  10.063976117   10.063976116
208      9  10.045061409   10.045061409
209      9   9.674904022    9.674904021
210      9  10.454830701   10.454830700
211      9   8.690436648    8.690436648
212      9   8.371548545    8.371548545
213      9   9.134786355    9.134786355
214      9   9.165463082    9.165463081
215      9   8.828644298    8.828644298
216      9   9.600661595    9.600661595
217      9   9.517224050    9.517224049
218      9   9.167094090    9.167094089
219      9   9.943567233    9.943567232
220      9  10.597617251   10.597617250
221      9  10.206426100   10.206426099
222      9  10.985855163   10.985855163
223      9   5.797197265    5.797197264
224      9   5.586401037    5.586401037
225      9   6.225686448    6.225686448
226      9  10.076198755   10.076198754
227      9   9.704857945    9.704857944
228      9  10.484867976   10.484867976
229      9   6.232149551    6.232149550
230      9   6.005226187    6.005226187
231      9   6.671050821    6.671050820
232      9   9.739486434    9.739486434
233      9   9.380931090    9.380931090
234      9  10.159329342   10.159329342
235      9   9.350031285    9.350031284
236      9   9.006231696    9.006231695
237      9   9.780802933    9.780802933
238      9  10.553640466   10.553640465
239      9  10.164125913   10.164125913
240      9  10.943747495   10.943747495
> ## consistency :
> stopifnot(
+     identical(is.na(n1prD1), is.na(n2prD1)),
+     identical(sort(unique(newD[is.na(n2prD1), "TreeID"])), 100:102),
+     sort(unique( newD[is.na(n2prD1), "TreeID"] )) %in% 100:102 ,
+     all.equal(as.vector(n1prD0), n1prD01[,"predict.fixed"], tolerance= 1e-15),
+     all.equal(as.vector(n2prD0), n2prD01[,"predict.fixed"], tolerance= 1e-15),
+     all.equal(as.vector(n1prD1), n1prD01[,"predict.TreeID"],tolerance= 1e-15),
+     all.equal(as.vector(n2prD1), n2prD01[,"predict.TreeID"],tolerance= 1e-15))
> 
